---
title: "Take-home Exercise 1"
author: "Chang Fang Yu"
date-modified: "last-modified"
execute:
  echo: False
  eval: True
  warning: false
  freeze: true
---

1.  **Overview**

2.  **Getting Started\
    **Setting the Analytical Tools\*\*
```{R}
pacman::p_load(tidyverse, haven, knitr,
               patchwork, ggthemes, scales,
               ggridges, ggpubr, gganimate, ggraph,
               ggdist, ggtext, ggalt, dplyr,
               cowplot, ggnewscale, ggmosaic, hrbrthemes, DT, tidymodels, plotly)
```

```         
**Data Sources**
```
3.  **Data Pre-processing**

    **Importing Data**

```{R}
Ship <- read_csv("data/Ship_Performance_Dataset.csv")
```
```{R}
glimpse(Ship)
```
```{R}
DT::datatable(Ship, class= "compact")
```
**Checking for Duplicates and Missing Values**
```{R}
Ship[duplicated(Ship),]
```
```{R}
sum(is.na(Ship))
```

4.  **EDA**

```{R}
numerical_vars <- c("Speed_Over_Ground_knots", "Distance_Traveled_nm",
                    "Draft_meters", "Cargo_Weight_tons", "Turnaround_Time_hours", "Efficiency_nm_per_kWh","Seasonal_Impact_Score", "Weekly_Voyage_Count", "Average_Load_Percentage", "Engine_Power_kW", "Operational_Cost_USD", "Revenue_per_Voyage_USD" )


numerical_data <- Ship %>%
  select(all_of(numerical_vars))


ship_long_num <- Ship %>%
  pivot_longer(cols = all_of(numerical_vars), names_to = "Variable", values_to = "Value")

p <- ggplot(ship_long_num, aes(x = Value, fill = Variable)) +
  geom_histogram(alpha = 0.5, bins = 30, color = "black") +
  facet_wrap(~ Variable, scales = "free", ncol = 3) + 
  theme_minimal() +
  theme(
    plot.margin = margin(10, 10, 30, 10),
    axis.text.x = element_blank(),  # 隱藏 x 軸標籤
    legend.text = element_text(size = 7),
    panel.spacing = unit(2, "cm")
  ) +
  labs(title = "Histogram of Numeric Variables")

interactive_p <- ggplotly(p)


interactive_p
```

```{R}

numerical_vars_1 <- c("Speed_Over_Ground_knots", "Engine_Power_kW", "Distance_Traveled_nm", 
                    "Cargo_Weight_tons", "Operational_Cost_USD", "Revenue_per_Voyage_USD", "Turnaround_Time_hours", "Efficiency_nm_per_kWh", "Seasonal_Impact_Score",
                    "Weekly_Voyage_Count", "Average_Load_Percentage")

ship_long <- Ship %>%
  pivot_longer(cols = all_of(numerical_vars_1), names_to = "Variable", values_to = "Value")

p <- ggplot(ship_long, aes(x = Variable, y = Value, fill = Variable)) +
  geom_boxplot(outlier.color = "red", outlier.size = 5) +
  facet_wrap(~ Variable, scales = "free", ncol = 3) +  
  theme_minimal() +
  theme(axis.text.x = element_text(hjust = 1, size = 7),  
        strip.text = element_text(size = 8),  
        legend.position = "bottom",
         panel.spacing = unit(1, "cm") ) +  
  labs(title = "Facet Wrap Box Plot of Numerical Variables")

ggplotly(p)


```

```{R}
categorical_vars <- c("Ship_Type", "Route_Type", "Engine_Type", 
                      "Maintenance_Status", "Weather_Condition")

ship_long_cat <- Ship %>%
  pivot_longer(cols = all_of(categorical_vars), names_to = "Variable", values_to = "Category")

p <- ggplot(ship_long_cat, aes(x = Category, fill = Category)) +
  geom_bar() +
  facet_wrap(~ Variable, scales = "free_x", ncol = 3) +  
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 10),  
    strip.text = element_text(size = 12),  
    legend.position = "none",  
    panel.spacing = unit(4, "cm")  
  ) +
  labs(title = "Distribution of Categorical Variables", x = "Category", y = "Count")

p_interactive <- ggplotly(p, tooltip = c("x", "y"))

p_interactive
```

5.  **Summary and Conclusion**

6.  **References**

